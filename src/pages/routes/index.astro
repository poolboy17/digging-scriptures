---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import CdnImage from '../../components/CdnImage.astro';

const routes = await getCollection('routes', ({ data }) => !data.draft);
---

<BaseLayout 
    title="Pilgrimage Routes" 
    description="Explore ancient and modern pilgrimage routes walked across centuries and continents."
    breadcrumbs={[
        { name: 'Home', url: '/' },
        { name: 'Pilgrimage Routes', url: '/routes' }
    ]}
>
    <section class="section">
        <div class="container">
            <h1 class="page-heading">Pilgrimage Routes</h1>

            {routes.length > 0 ? (
                <div class="grid gap-8 sm:grid-cols-2">
                    {routes.map((route, i) => (
                        <a href={`/routes/${route.slug}`} class="card block">
                            {route.data.image && (
                                <div class="overflow-hidden rounded-t-xl">
                                    <CdnImage 
                                        src={route.data.image} 
                                        alt={route.data.imageAlt || `${route.data.title} pilgrimage route`}
                                        width={445} height={250}
                                        loading={i < 2 ? 'eager' : 'lazy'}
                                        fetchpriority={i === 0 ? 'high' : undefined}
                                        decoding={i < 2 ? 'sync' : 'async'}
                                        class="w-full aspect-[445/250] object-cover"
                                    />
                                </div>
                            )}
                            <div class="p-4">
                                <div class="card-meta">
                                    <span class="badge">Route</span>
                                    {route.data.distanceKm && <span>{route.data.distanceKm} km</span>}
                                </div>
                                <h3 class="mb-2 text-text-dark">{route.data.title}</h3>
                                <p class="text-sm text-text-muted leading-relaxed line-clamp-2">{route.data.description}</p>
                            </div>
                        </a>
                    ))}
                </div>
            ) : (
                <p class="text-center text-text-muted italic">Content coming soon.</p>
            )}
        </div>
    </section>
</BaseLayout>
