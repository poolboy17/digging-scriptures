---
/**
 * ================================================================================
 * ROUTE PAGE TEMPLATE
 * ================================================================================
 * Purpose: Pilgrimage routes and paths
 * Word count target: 1200-2500 words
 * 
 * MONETIZATION: OPTIONAL
 * Allowed ONLY in Section 5: "Modern Pilgrimage Experiences"
 * All other sections: NO monetization
 * 
 * This template is LOCKED. Do not modify section order without review.
 * ================================================================================
 */

import BaseLayout from './BaseLayout.astro';
import CdnImage from '../components/CdnImage.astro';
import PilgrimageSidebar from '../components/PilgrimageSidebar.astro';

interface SidebarProduct {
    title: string;
    url: string;
    image?: string;
    tier: 'hero' | 'value' | 'premium';
    price?: string;
    rating?: number;
    reviews?: number;
    label?: string;
    duration?: string;
}

interface Props {
    title: string;
    description: string;
    region: string;
    countries: string[];
    distanceKm?: number;
    typicalDurationDays?: number;
    faithTraditions?: string[];
    difficulty?: string;
    hasModernSection?: boolean;
    sidebarProducts?: SidebarProduct[];
    image?: string;
    imageAlt?: string;
    imageCredit?: string;
}

const { 
    title, 
    description, 
    region, 
    countries,
    distanceKm,
    typicalDurationDays,
    faithTraditions, 
    difficulty,
    hasModernSection = false,
    sidebarProducts = [],
    image,
    imageAlt,
    imageCredit,
} = Astro.props;

const hasSidebar = sidebarProducts.length > 0;
---

<BaseLayout 
    title={title} 
    description={description}
    breadcrumbs={[
        { name: 'Home', url: '/' },
        { name: 'Routes', url: '/routes' },
        { name: title, url: Astro.url.pathname }
    ]}
    schema={{
        "@context": "https://schema.org",
        "@type": "TouristTrip",
        "name": title,
        "description": description,
        "url": `https://diggingscriptures.com${Astro.url.pathname}`,
        "touristType": "Pilgrim"
    }}
>
    <article class="section">
        <div class="container">

        <div class:list={["flex gap-8", hasSidebar && "lg:flex-row flex-col"]}>
        <div class:list={[hasSidebar ? "lg:w-2/3" : "w-full"]}>
        
            <!-- HERO IMAGE -->
            {image && (
                <div class="hero-image mb-8 rounded-xl overflow-hidden">
                    <CdnImage src={image} alt={imageAlt || title} loading="eager" fetchpriority="high" width={1080} height={720} sizes="(max-width: 1080px) 100vw, 1080px" class="w-full object-cover rounded-xl" style="max-height:420px;" />
                    {imageCredit && <p class="text-xs text-text-light mt-2">{imageCredit}</p>}
                </div>
            )}

            <!-- SECTION 1: HEADER -->
            <header class="mb-10">
                <div class="card-meta mb-4">
                    <span class="badge">Route</span>
                    <span>{region}</span>
                </div>
                <h1 class="mb-4">{title}</h1>
                <p class="text-lg text-text-muted leading-relaxed mb-6">{description}</p>
                
                <!-- Route quick facts -->
                <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
                    {countries && (
                        <div class="bg-light rounded-lg p-3 text-center">
                            <p class="text-xs text-text-muted uppercase tracking-wider">Countries</p>
                            <p class="text-sm font-semibold text-text-dark">{countries.join(', ')}</p>
                        </div>
                    )}
                    {distanceKm && (
                        <div class="bg-light rounded-lg p-3 text-center">
                            <p class="text-xs text-text-muted uppercase tracking-wider">Distance</p>
                            <p class="text-sm font-semibold text-text-dark">{distanceKm} km</p>
                        </div>
                    )}
                    {typicalDurationDays && (
                        <div class="bg-light rounded-lg p-3 text-center">
                            <p class="text-xs text-text-muted uppercase tracking-wider">Duration</p>
                            <p class="text-sm font-semibold text-text-dark">{typicalDurationDays} days</p>
                        </div>
                    )}
                    {difficulty && (
                        <div class="bg-light rounded-lg p-3 text-center">
                            <p class="text-xs text-text-muted uppercase tracking-wider">Difficulty</p>
                            <p class="text-sm font-semibold text-text-dark">{difficulty}</p>
                        </div>
                    )}
                </div>
            </header>

            <!-- SECTION 2: HISTORICAL ORIGINS -->
            <section class="content mb-10">
                <h2>Historical Origins</h2>
                <slot name="history" />
            </section>

            <!-- SECTION 3: THE JOURNEY -->
            <section class="content mb-10 pt-8 border-t border-border">
                <h2>The Journey</h2>
                {faithTraditions && faithTraditions.length > 0 && (
                    <p class="text-sm text-text-muted italic mb-4">
                        Associated traditions: {faithTraditions.join(', ')}
                    </p>
                )}
                <slot name="journey" />
            </section>

            <!-- SECTION 4: SIGNIFICANT PLACES -->
            <section class="content mb-10 pt-8 border-t border-border">
                <h2>Significant Places Along the Way</h2>
                <slot name="places" />
            </section>

            <!-- SECTION 5: MODERN EXPERIENCES (MONETIZATION ALLOWED) -->
            {hasModernSection && (
                <section class="content mb-10 pt-8 border-t border-border">
                    <h2>Modern Pilgrimage Experiences</h2>
                    <slot name="modern" />
                </section>
            )}

            <!-- SECTION 6: RELATED CONTENT -->
            <section class="mt-12 pt-8 border-t border-border">
                <h2 class="mb-4">Related Content</h2>
                <slot name="related" />
            </section>

        </div>

        {hasSidebar && (
            <PilgrimageSidebar products={sidebarProducts} heading="Plan Your Journey" />
        )}
        </div>

        </div>
    </article>
</BaseLayout>
