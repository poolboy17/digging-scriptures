---
/**
 * ================================================================================
 * PLACE PAGE TEMPLATE
 * ================================================================================
 * Purpose: Destinations and sacred sites
 * Word count target: 1200-2500 words
 * 
 * MONETIZATION: OPTIONAL
 * Allowed ONLY in Section 5: "Experiencing This Place Today"
 * All other sections: NO monetization
 * 
 * This template is LOCKED. Do not modify section order without review.
 * ================================================================================
 */

import BaseLayout from './BaseLayout.astro';
import CdnImage from '../components/CdnImage.astro';
import PilgrimageSidebar from '../components/PilgrimageSidebar.astro';
import SpokeSidebar from '../components/SpokeSidebar.astro';
import SpokeMobileToc from '../components/SpokeMobileToc.astro';

interface SidebarProduct {
    title: string;
    url: string;
    image?: string;
    tier: 'hero' | 'value' | 'premium';
    price?: string;
    rating?: number;
    reviews?: number;
    label?: string;
    duration?: string;
}

interface Props {
    title: string;
    description: string;
    region: string;
    country: string;
    faithTraditions?: string[];
    placeType?: string;
    hasExperienceSection?: boolean;
    sidebarProducts?: SidebarProduct[];
    image?: string;
    imageAlt?: string;
    imageCredit?: string;
}

const { 
    title, 
    description, 
    region, 
    country, 
    faithTraditions, 
    placeType,
    hasExperienceSection = false,
    sidebarProducts = [],
    image,
    imageAlt,
    imageCredit,
} = Astro.props;

const hasSidebar = sidebarProducts.length > 0;
---

<BaseLayout 
    title={title} 
    description={description}
    image={image}
    breadcrumbs={[
        { name: 'Home', url: '/' },
        { name: 'Places', url: '/places' },
        { name: title, url: Astro.url.pathname }
    ]}
    schema={{
        "@context": "https://schema.org",
        "@type": "TouristDestination",
        "name": title,
        "description": description,
        "url": `https://diggingscriptures.com${Astro.url.pathname}`,
        "containedInPlace": {
            "@type": "Country",
            "name": country
        }
    }}
>
    <article class="section">
        <div class="container">

        <SpokeMobileToc />
        <div class="spoke-layout">
        <div class="spoke-main">

        
            <!-- HERO IMAGE -->
            {image && (
                <div class="hero-image mb-8 rounded-xl overflow-hidden">
                    <CdnImage src={image} alt={imageAlt || title} loading="eager" fetchpriority="high" width={1080} height={720} sizes="(max-width: 1080px) 100vw, 1080px" class="w-full object-cover rounded-xl" style="max-height:420px;" />
                    {imageCredit && <p class="text-xs text-text-light mt-2">{imageCredit}</p>}
                </div>
            )}

            <!-- SECTION 1: HEADER -->
            <header class="mb-10">
                <div class="card-meta mb-4">
                    <span class="badge">{placeType || 'Sacred Place'}</span>
                    <span>{region}, {country}</span>
                </div>
                <h1 class="mb-4">{title}</h1>
                <p class="text-lg text-text-muted leading-relaxed">{description}</p>
                {faithTraditions && faithTraditions.length > 0 && (
                    <p class="text-sm text-text-muted italic mt-3">
                        Associated traditions: {faithTraditions.join(', ')}
                    </p>
                )}
            </header>

            <!-- ARTICLE CONTENT -->
            <div class="content">
                <slot />
            </div>

        </div>
        <SpokeSidebar products={sidebarProducts} productHeading="Plan Your Visit" />
        </div>

        </div>
    </article>
</BaseLayout>
