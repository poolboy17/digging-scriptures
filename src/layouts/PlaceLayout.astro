---
/**
 * ================================================================================
 * PLACE PAGE TEMPLATE
 * ================================================================================
 * Purpose: Destinations and sacred sites
 * Word count target: 1200-2500 words
 * 
 * MONETIZATION: OPTIONAL
 * Allowed ONLY in Section 5: "Experiencing This Place Today"
 * All other sections: NO monetization
 * 
 * This template is LOCKED. Do not modify section order without review.
 * ================================================================================
 */

import BaseLayout from './BaseLayout.astro';
import PilgrimageSidebar from '../components/PilgrimageSidebar.astro';

interface SidebarProduct {
    title: string;
    url: string;
    image?: string;
    tier: 'hero' | 'value' | 'premium';
    price?: string;
    rating?: number;
    reviews?: number;
    label?: string;
    duration?: string;
}

interface Props {
    title: string;
    description: string;
    region: string;
    country: string;
    faithTraditions?: string[];
    placeType?: string;
    hasExperienceSection?: boolean;
    sidebarProducts?: SidebarProduct[];
}

const { 
    title, 
    description, 
    region, 
    country, 
    faithTraditions, 
    placeType,
    hasExperienceSection = false,
    sidebarProducts = []
} = Astro.props;

const hasSidebar = sidebarProducts.length > 0;
---

<BaseLayout 
    title={title} 
    description={description}
    breadcrumbs={[
        { name: 'Home', url: '/' },
        { name: 'Places', url: '/places' },
        { name: title, url: Astro.url.pathname }
    ]}
    schema={{
        "@context": "https://schema.org",
        "@type": "TouristDestination",
        "name": title,
        "description": description,
        "url": `https://diggingscriptures.com${Astro.url.pathname}`,
        "containedInPlace": {
            "@type": "Country",
            "name": country
        }
    }}
>
    <article class="section">
        <div class="container">

        <div class:list={["flex gap-8", hasSidebar && "lg:flex-row flex-col"]}>
        <div class:list={[hasSidebar ? "lg:w-2/3" : "w-full"]}>

        
            <!-- SECTION 1: HEADER -->
            <header class="mb-10">
                <div class="card-meta mb-4">
                    <span class="badge">{placeType || 'Sacred Place'}</span>
                    <span>{region}, {country}</span>
                </div>
                <h1 class="mb-4">{title}</h1>
                <p class="text-lg text-text-muted leading-relaxed">{description}</p>
            </header>

            <!-- SECTION 2: HISTORICAL SIGNIFICANCE -->
            <section class="content mb-10">
                <h2>Historical Significance</h2>
                <slot name="history" />
            </section>

            <!-- SECTION 3: CULTURAL CONTEXT -->
            <section class="content mb-10 pt-8 border-t border-border">
                <h2>Cultural and Spiritual Context</h2>
                {faithTraditions && faithTraditions.length > 0 && (
                    <p class="text-sm text-text-muted italic mb-4">
                        Associated traditions: {faithTraditions.join(', ')}
                    </p>
                )}
                <slot name="culture" />
            </section>

            <!-- SECTION 4: NOTABLE FEATURES -->
            <section class="content mb-10 pt-8 border-t border-border">
                <h2>Notable Features</h2>
                <slot name="features" />
            </section>

            <!-- SECTION 5: EXPERIENCING THIS PLACE TODAY (MONETIZATION ALLOWED) -->
            {hasExperienceSection && (
                <section class="content mb-10 pt-8 border-t border-border">
                    <h2>Experiencing This Place Today</h2>
                    <slot name="experience" />
                </section>
            )}

            <!-- SECTION 6: RELATED CONTENT -->
            <section class="mt-12 pt-8 border-t border-border">
                <h2 class="mb-4">Related Content</h2>
                <slot name="related" />
            </section>

        </div>

        {hasSidebar && (
            <PilgrimageSidebar products={sidebarProducts} heading="Plan Your Visit" />
        )}
        </div>

        </div>
    </article>
</BaseLayout>
