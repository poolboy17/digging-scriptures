---
/**
 * Site-wide header navigation for Digging Scriptures.
 * Responsive: horizontal nav on desktop, hamburger menu on mobile.
 */

const navItems = [
    { linkText: 'Journeys', href: '/journeys' },
    { linkText: 'Places', href: '/places' },
    { linkText: 'Routes', href: '/routes' },
    { linkText: 'Stories', href: '/stories' },
    { linkText: 'Context', href: '/context' },
];

const currentPath = Astro.url.pathname;
---

<header class="header">
    <a href="/" class="header-logo">
        <span class="header-logo-mark">DS</span>
        <span class="header-logo-text">Digging Scriptures</span>
    </a>

    {/* Desktop nav */}
    <ul class="header-nav-desktop">
        {navItems.map((item) => (
            <li>
                <a 
                    href={item.href} 
                    class:list={[
                        "header-nav-link",
                        (currentPath === item.href || currentPath.startsWith(item.href + '/'))
                            && "header-nav-link--active"
                    ]}
                >
                    {item.linkText}
                </a>
            </li>
        ))}
    </ul>

    {/* Mobile hamburger */}
    <button class="header-burger" id="menu-toggle" aria-label="Toggle menu" aria-expanded="false">
        <span class="header-burger-line"></span>
        <span class="header-burger-line"></span>
        <span class="header-burger-line"></span>
    </button>
</header>

{/* Mobile nav drawer */}
<nav class="mobile-nav" id="mobile-nav" aria-hidden="true">
    <ul class="mobile-nav-list">
        {navItems.map((item) => (
            <li>
                <a 
                    href={item.href} 
                    class:list={[
                        "mobile-nav-link",
                        (currentPath === item.href || currentPath.startsWith(item.href + '/'))
                            && "mobile-nav-link--active"
                    ]}
                >
                    {item.linkText}
                </a>
            </li>
        ))}
    </ul>
</nav>

<script>
    const toggle = document.getElementById('menu-toggle');
    const nav = document.getElementById('mobile-nav');
    toggle?.addEventListener('click', () => {
        const open = nav?.classList.toggle('mobile-nav--open');
        toggle.classList.toggle('header-burger--open');
        toggle.setAttribute('aria-expanded', String(!!open));
        nav?.setAttribute('aria-hidden', String(!open));
    });
</script>

<style>
    .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0.875rem 0;
    }
    @media (min-width: 640px) { .header { padding: 1.25rem 0; } }

    .header-logo {
        display: flex; align-items: center; gap: 0.5rem;
        font-size: 1.0625rem; font-weight: 700;
        color: var(--color-text-dark); text-decoration: none;
        letter-spacing: -0.01em; transition: opacity 0.2s; flex-shrink: 0;
    }
    .header-logo:hover { opacity: 0.8; }
    .header-logo-mark {
        display: inline-flex; align-items: center; justify-content: center;
        width: 1.875rem; height: 1.875rem; border-radius: 0.5rem;
        background: var(--color-primary); color: var(--color-primary-content);
        font-size: 0.6875rem; font-weight: 900;
    }

    /* Desktop nav — hidden below 768px */
    .header-nav-desktop {
        display: none; list-style: none; margin: 0; padding: 0; gap: 0.125rem;
    }
    @media (min-width: 768px) {
        .header-nav-desktop { display: flex; align-items: center; }
    }
    .header-nav-link {
        display: inline-block; padding: 0.375rem 0.75rem; border-radius: 0.5rem;
        font-size: 0.875rem; font-weight: 500; color: var(--color-text-muted);
        text-decoration: none; transition: all 0.15s;
    }
    .header-nav-link:hover { color: var(--color-text-dark); background: var(--color-light); }
    .header-nav-link--active {
        color: var(--color-primary);
        background: color-mix(in srgb, var(--color-primary) 8%, transparent);
        font-weight: 600;
    }

    /* Hamburger — visible below 768px */
    .header-burger {
        display: flex; flex-direction: column; justify-content: center; gap: 5px;
        width: 2.25rem; height: 2.25rem; padding: 0.375rem;
        border: none; background: none; cursor: pointer;
        border-radius: 0.375rem; transition: background 0.15s;
    }
    .header-burger:hover { background: var(--color-light); }
    @media (min-width: 768px) { .header-burger { display: none; } }

    .header-burger-line {
        display: block; width: 100%; height: 2px;
        background: var(--color-text-dark); border-radius: 1px;
        transition: all 0.25s ease; transform-origin: center;
    }
    .header-burger--open .header-burger-line:nth-child(1) { transform: translateY(7px) rotate(45deg); }
    .header-burger--open .header-burger-line:nth-child(2) { opacity: 0; }
    .header-burger--open .header-burger-line:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }

    /* Mobile nav drawer */
    .mobile-nav { display: none; padding: 0 0 1rem; border-bottom: 1px solid var(--color-border); }
    @media (min-width: 768px) { .mobile-nav { display: none !important; } }
    .mobile-nav--open { display: block; }

    .mobile-nav-list { list-style: none; margin: 0; padding: 0; display: flex; flex-direction: column; gap: 0.125rem; }
    .mobile-nav-link {
        display: block; padding: 0.75rem 1rem; border-radius: 0.5rem;
        font-size: 1rem; font-weight: 500; color: var(--color-text-muted);
        text-decoration: none; transition: all 0.15s;
    }
    .mobile-nav-link:hover { background: var(--color-light); color: var(--color-text-dark); }
    .mobile-nav-link--active {
        color: var(--color-primary);
        background: color-mix(in srgb, var(--color-primary) 8%, transparent);
        font-weight: 600;
    }
</style>
